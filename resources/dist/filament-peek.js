(()=>{var A=(i,e)=>()=>(e||(e={exports:{}},i(e.exports,e)),e.exports);var O=A((re,x)=>{var D="Expected a function",M=0/0,F="[object Symbol]",B=/^\s+|\s+$/g,H=/^[-+]0x[0-9a-f]+$/i,U=/^0b[01]+$/i,_=/^0o[0-7]+$/i,N=parseInt,X=typeof global=="object"&&global&&global.Object===Object&&global,K=typeof self=="object"&&self&&self.Object===Object&&self,q=X||K||Function("return this")(),$=Object.prototype,G=$.toString,J=Math.max,Q=Math.min,w=function(){return q.Date.now()};function V(i,e,t){var n,l,u,d,s,a,f=0,E=!1,c=!1,g=!0;if(typeof i!="function")throw new TypeError(D);e=R(e)||0,S(t)&&(E=!!t.leading,c="maxWait"in t,u=c?J(R(t.maxWait)||0,e):u,g="trailing"in t?!!t.trailing:g);function b(r){var o=n,h=l;return n=l=void 0,f=r,d=i.apply(h,o),d}function W(r){return f=r,s=setTimeout(m,e),E?b(r):d}function L(r){var o=r-a,h=r-f,T=e-o;return c?Q(T,u-h):T}function P(r){var o=r-a,h=r-f;return a===void 0||o>=e||o<0||c&&h>=u}function m(){var r=w();if(P(r))return I(r);s=setTimeout(m,L(r))}function I(r){return s=void 0,g&&n?b(r):(n=l=void 0,d)}function j(){s!==void 0&&clearTimeout(s),f=0,n=a=l=s=void 0}function z(){return s===void 0?d:I(w())}function y(){var r=w(),o=P(r);if(n=arguments,l=this,a=r,o){if(s===void 0)return W(a);if(c)return s=setTimeout(m,e),b(a)}return s===void 0&&(s=setTimeout(m,e)),d}return y.cancel=j,y.flush=z,y}function S(i){var e=typeof i;return!!i&&(e=="object"||e=="function")}function Y(i){return!!i&&typeof i=="object"}function Z(i){return typeof i=="symbol"||Y(i)&&G.call(i)==F}function R(i){if(typeof i=="number")return i;if(Z(i))return M;if(S(i)){var e=typeof i.valueOf=="function"?i.valueOf():i;i=S(e)?e+"":e}if(typeof i!="string")return i===0?i:+i;i=i.replace(B,"");var t=U.test(i);return t||_.test(i)?N(i.slice(2),t?2:8):H.test(i)?M:+i}x.exports=V});function v(i,e,t={}){i.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0,composed:!0,cancelable:!0}))}var ee=O(),k=[],C={onEditorFocusOut(i){k.push(i)}},p={initialWidth:0,initialX:0};document.addEventListener("alpine:init",()=>{v(document,"peek:initializing"),Alpine.data("PeekPreviewModal",i=>({config:i,isOpen:!1,withEditor:!1,editorHasSidebarActions:!1,editorIsResizable:!1,editorIsResizing:!1,canRotatePreset:!1,activeDevicePreset:null,editorTitle:null,modalTitle:null,iframeUrl:null,iframeContent:null,modalStyle:{display:"none"},iframeStyle:{width:"100%",height:"100%",maxWidth:"100%",maxHeight:"100%"},editorStyle:{display:"none"},init(){let e=this.config.editorAutoRefreshDebounceTime||500,t=this.config.editorSidebarMinWidth||"30rem",n=this.config.editorSidebarInitialWidth||"30rem";this.refreshBuilderPreview=ee(()=>Livewire.emit("refreshBuilderPreview"),e),this.editorStyle.width=n,this.config.canResizeEditorSidebar&&(this.editorStyle.minWidth=t,this.editorIsResizable=!0),this.setDevicePreset()},setIframeDimensions(e,t){this.iframeStyle.maxWidth=e,this.iframeStyle.maxHeight=t,this.config.allowIframeOverflow&&(this.iframeStyle.width=e,this.iframeStyle.height=t)},setDevicePreset(e){e=e||this.config.initialDevicePreset,!!this.config.devicePresets&&(!this.config.devicePresets[e]||!this.config.devicePresets[e].width||!this.config.devicePresets[e].height||(this.setIframeDimensions(this.config.devicePresets[e].width,this.config.devicePresets[e].height),this.canRotatePreset=this.config.devicePresets[e].canRotatePreset||!1,this.activeDevicePreset=e))},isActiveDevicePreset(e){return this.config.shouldShowActiveDevicePreset?this.activeDevicePreset===e:!1},rotateDevicePreset(){let e=this.iframeStyle.maxHeight,t=this.iframeStyle.maxWidth;this.setIframeDimensions(e,t)},onOpenPreviewModal(e){document.body.classList.add("is-filament-peek-preview-modal-open"),this.withEditor=!!e.detail.withEditor,this.editorHasSidebarActions=!!e.detail.editorHasSidebarActions,this.editorIsResizing=!1,this.editorTitle=e.detail.editorTitle,this.editorStyle.display=this.withEditor?"flex":"none",this.modalTitle=e.detail.modalTitle,this.iframeUrl=e.detail.iframeUrl,this.iframeContent=e.detail.iframeContent,this.modalStyle.display="flex",this.isOpen=!0,setTimeout(()=>this._focusEditorFirstInput(),0),setTimeout(()=>this._attachIframeEscapeKeyListener(),500)},_focusEditorFirstInput(){if(!this.withEditor)return;let e=this.$el.querySelector(".filament-peek-builder-editor input");e&&e.focus()},_attachIframeEscapeKeyListener(){let e=this.$refs.previewModalBody.querySelector("iframe");!(e&&e.contentWindow)||e.contentWindow.addEventListener("keyup",t=>{t.key==="Escape"&&this.handleEscapeKey()})},onRefreshPreviewModal(e){this.iframeUrl=e.detail.iframeUrl,this.iframeContent=e.detail.iframeContent},onClosePreviewModal(e){setTimeout(()=>this._closeModal(),e?.detail?.delay?250:0)},_closeModal(){document.body.classList.remove("is-filament-peek-preview-modal-open"),this.withEditor=!1,this.editorHasSidebarActions=!1,this.editorIsResizing=!1,this.editorStyle.display="none",this.editorTitle=null,this.modalStyle.display="none",this.modalTitle=null,this.iframeUrl=null,this.iframeContent=null,this.isOpen=!1},onEditorFocusOut(e){if(!!this.editorShouldAutoRefresh())for(let t of k)typeof t=="function"&&t(e,this)},editorShouldAutoRefresh(){if(!!this.withEditor&&!!this.$refs.builderEditor)return!!this.$refs.builderEditor.dataset.shouldAutoRefresh},handleEscapeKey(){!this.isOpen||!this.config.shouldCloseModalWithEscapeKey||this.withEditor||this.onClosePreviewModal()},acceptEditorChanges(){Livewire.emit("closeBuilderEditor")},discardEditorChanges(){this.$dispatch("close-preview-modal")},closePreviewModal(){this.$dispatch("close-preview-modal")},onEditorResizerMouseDown(e){!this.$refs.builderEditor||(this.editorIsResizing=!0,p.initialWidth=parseFloat(getComputedStyle(this.$refs.builderEditor).width),p.initialX=e.clientX)},onMouseUp(e){!this.editorIsResizing||(this.editorIsResizing=!1)},onMouseMove(e){!this.editorIsResizing||(this.editorStyle.width=p.initialWidth+(e.clientX-p.initialX)+"px")}})),v(document,"peek:initialized")});document.addEventListener("peek:initializing",()=>{C.onEditorFocusOut((i,e)=>{if(["input","select","textarea","trix-editor","hex-color-picker"].includes(i.target.tagName.toLowerCase())){e.refreshBuilderPreview();return}if(i.target.tagName.toLowerCase()==="button"&&i.target.getAttribute("role")==="switch"){e.refreshBuilderPreview();return}if(i.target.classList.contains("ProseMirror")){e.refreshBuilderPreview();return}})});window.FilamentPeek=C;})();
