(()=>{var k=(t,e)=>()=>(e||(e={exports:{}},t(e.exports,e)),e.exports);var O=k((Y,S)=>{var D="Expected a function",x=0/0,A="[object Symbol]",R=/^\s+|\s+$/g,W=/^[-+]0x[0-9a-f]+$/i,_=/^0b[01]+$/i,B=/^0o[0-7]+$/i,U=parseInt,F=typeof global=="object"&&global&&global.Object===Object&&global,N=typeof self=="object"&&self&&self.Object===Object&&self,H=F||N||Function("return this")(),K=Object.prototype,q=K.toString,$=Math.max,G=Math.min,v=function(){return H.Date.now()};function X(t,e,r){var a,f,u,l,s,o,d=0,w=!1,c=!1,g=!0;if(typeof t!="function")throw new TypeError(D);e=I(e)||0,b(r)&&(w=!!r.leading,c="maxWait"in r,u=c?$(I(r.maxWait)||0,e):u,g="trailing"in r?!!r.trailing:g);function p(i){var n=a,h=f;return a=f=void 0,d=i,l=t.apply(h,n),l}function C(i){return d=i,s=setTimeout(m,e),w?p(i):l}function M(i){var n=i-o,h=i-d,T=e-n;return c?G(T,u-h):T}function P(i){var n=i-o,h=i-d;return o===void 0||n>=e||n<0||c&&h>=u}function m(){var i=v();if(P(i))return E(i);s=setTimeout(m,M(i))}function E(i){return s=void 0,g&&a?p(i):(a=f=void 0,l)}function L(){s!==void 0&&clearTimeout(s),d=0,a=o=f=s=void 0}function j(){return s===void 0?l:E(v())}function y(){var i=v(),n=P(i);if(a=arguments,f=this,o=i,n){if(s===void 0)return C(o);if(c)return s=setTimeout(m,e),p(o)}return s===void 0&&(s=setTimeout(m,e)),l}return y.cancel=L,y.flush=j,y}function b(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function z(t){return!!t&&typeof t=="object"}function J(t){return typeof t=="symbol"||z(t)&&q.call(t)==A}function I(t){if(typeof t=="number")return t;if(J(t))return x;if(b(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=b(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(R,"");var r=_.test(t);return r||B.test(t)?U(t.slice(2),r?2:8):W.test(t)?x:+t}S.exports=X});var Q=O();document.addEventListener("alpine:init",()=>{Alpine.data("PeekPreviewModal",t=>({config:t,isOpen:!1,withEditor:!1,canRotatePreset:!1,activeDevicePreset:null,editorTitle:null,modalTitle:null,iframeUrl:null,iframeContent:null,modalStyle:{display:"none"},iframeStyle:{width:"100%",height:"100%",maxWidth:"100%",maxHeight:"100%"},editorStyle:{display:"none"},init(){let e=this.config.editorAutoRefreshDebounceTime||500;this._refreshBuilderPreview=Q(()=>Livewire.emit("refreshBuilderPreview"),e),this.setDevicePreset()},setIframeDimensions(e,r){this.iframeStyle.maxWidth=e,this.iframeStyle.maxHeight=r,this.config.allowIframeOverflow&&(this.iframeStyle.width=e,this.iframeStyle.height=r)},setDevicePreset(e){e=e||this.config.initialDevicePreset,!!this.config.devicePresets&&(!this.config.devicePresets[e]||!this.config.devicePresets[e].width||!this.config.devicePresets[e].height||(this.setIframeDimensions(this.config.devicePresets[e].width,this.config.devicePresets[e].height),this.canRotatePreset=this.config.devicePresets[e].canRotatePreset||!1,this.activeDevicePreset=e))},isActiveDevicePreset(e){return this.config.shouldShowActiveDevicePreset?this.activeDevicePreset===e:!1},rotateDevicePreset(){let e=this.iframeStyle.maxHeight,r=this.iframeStyle.maxWidth;this.setIframeDimensions(e,r)},onOpenPreviewModal(e){document.body.classList.add("is-filament-peek-preview-modal-open"),this.withEditor=!!e.detail.withEditor,this.editorTitle=e.detail.editorTitle,this.editorStyle.display=this.withEditor?"flex":"none",this.modalTitle=e.detail.modalTitle,this.iframeUrl=e.detail.iframeUrl,this.iframeContent=e.detail.iframeContent,this.modalStyle.display="flex",this.isOpen=!0,setTimeout(()=>this._focusEditorFirstInput(),0),setTimeout(()=>this._attachIframeEscapeKeyListener(),500)},_focusEditorFirstInput(){if(!this.withEditor)return;let e=this.$el.querySelector(".filament-peek-builder-editor input");e&&e.focus()},_attachIframeEscapeKeyListener(){let e=this.$refs.previewModalBody.querySelector("iframe");!(e&&e.contentWindow)||e.contentWindow.addEventListener("keyup",r=>{r.key==="Escape"&&this.handleEscapeKey()})},onRefreshPreviewModal(e){this.iframeUrl=e.detail.iframeUrl,this.iframeContent=e.detail.iframeContent},onClosePreviewModal(e){setTimeout(()=>this._closeModal(),e?.detail?.delay?250:0)},_closeModal(){document.body.classList.remove("is-filament-peek-preview-modal-open"),this.withEditor=!1,this.editorStyle.display="none",this.editorTitle=null,this.modalStyle.display="none",this.modalTitle=null,this.iframeUrl=null,this.iframeContent=null,this.isOpen=!1},onEditorFocusOut(e){if(!this.editorShouldAutoRefresh())return;if(["input","select","textarea","trix-editor","hex-color-picker"].includes(e.target.tagName.toLowerCase())){this._refreshBuilderPreview();return}if(e.target.tagName.toLowerCase()==="button"&&e.target.getAttribute("role")==="switch"){this._refreshBuilderPreview();return}},editorShouldAutoRefresh(){if(!!this.withEditor&&!!this.$refs.builderEditor)return!!this.$refs.builderEditor.dataset.shouldAutoRefresh},handleEscapeKey(){!this.isOpen||!this.config.shouldCloseModalWithEscapeKey||this.withEditor||this.onClosePreviewModal()},acceptEditorChanges(){Livewire.emit("closeBuilderEditor")},discardEditorChanges(){this.$dispatch("close-preview-modal")},closePreviewModal(){this.$dispatch("close-preview-modal")}}))});})();
