(()=>{document.addEventListener("alpine:init",()=>{Alpine.data("PeekPreviewModal",t=>({config:t,isOpen:!1,withEditor:!1,canRotatePreset:!1,activeDevicePreset:null,editorTitle:null,modalTitle:null,iframeUrl:null,iframeContent:null,modalStyle:{display:"none"},iframeStyle:{width:"100%",height:"100%",maxWidth:"100%",maxHeight:"100%"},editorStyle:{display:"none"},init(){this.setDevicePreset()},setIframeDimensions(e,i){this.iframeStyle.maxWidth=e,this.iframeStyle.maxHeight=i,this.config.allowIframeOverflow&&(this.iframeStyle.width=e,this.iframeStyle.height=i)},setDevicePreset(e){e=e||this.config.initialDevicePreset,!!this.config.devicePresets&&(!this.config.devicePresets[e]||!this.config.devicePresets[e].width||!this.config.devicePresets[e].height||(this.setIframeDimensions(this.config.devicePresets[e].width,this.config.devicePresets[e].height),this.canRotatePreset=this.config.devicePresets[e].canRotatePreset||!1,this.activeDevicePreset=e))},isActiveDevicePreset(e){return this.config.shouldShowActiveDevicePreset?this.activeDevicePreset===e:!1},rotateDevicePreset(){let e=this.iframeStyle.maxHeight,i=this.iframeStyle.maxWidth;this.setIframeDimensions(e,i)},onOpenPreviewModal(e){document.body.classList.add("is-filament-peek-preview-modal-open"),this.withEditor=!!e.detail.withEditor,this.editorTitle=e.detail.editorTitle,this.editorStyle.display=this.withEditor?"flex":"none",this.modalTitle=e.detail.modalTitle,this.iframeUrl=e.detail.iframeUrl,this.iframeContent=e.detail.iframeContent,this.modalStyle.display="flex",this.isOpen=!0,setTimeout(()=>{let i=this.$el.querySelector(".filament-peek-builder-editor input");i&&i.focus()},0),setTimeout(()=>{let i=this.$refs.previewModalBody.querySelector("iframe");!(i&&i.contentWindow)||i.contentWindow.addEventListener("keyup",s=>{s.key==="Escape"&&this.handleEscapeKey()})},500)},onRefreshPreviewModal(e){this.iframeUrl=e.detail.iframeUrl,this.iframeContent=e.detail.iframeContent},onClosePreviewModal(e){setTimeout(()=>this._onClosePreviewModalInner(),e?.detail?.delay?250:0)},_onClosePreviewModalInner(){document.body.classList.remove("is-filament-peek-preview-modal-open"),this.withEditor=!1,this.editorStyle.display="none",this.editorTitle=null,this.modalStyle.display="none",this.modalTitle=null,this.iframeUrl=null,this.iframeContent=null,this.isOpen=!1},onEditorFocusOut(e){if(!this.editorShouldAutoRefresh())return;["input","trix-editor"].includes(e.target.tagName.toLowerCase())&&Livewire.emit("refreshBuilderPreview")},editorShouldAutoRefresh(){if(!!this.withEditor&&!!this.$refs.builderEditor)return!!this.$refs.builderEditor.dataset.shouldAutoRefresh},handleEscapeKey(){!this.isOpen||!this.config.shouldCloseModalWithEscapeKey||this.withEditor||this.onClosePreviewModal()},dispatchCloseModalEvent(){this.withEditor?Livewire.emit("closeBuilderEditor"):this.$dispatch("close-preview-modal")}}))});})();
