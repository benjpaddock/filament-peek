(()=>{var R=(t,e)=>()=>(e||(e={exports:{}},t(e.exports,e)),e.exports);var k=R((ie,x)=>{var W="Expected a function",O=0/0,B="[object Symbol]",F=/^\s+|\s+$/g,H=/^[-+]0x[0-9a-f]+$/i,_=/^0b[01]+$/i,U=/^0o[0-7]+$/i,N=parseInt,K=typeof global=="object"&&global&&global.Object===Object&&global,q=typeof self=="object"&&self&&self.Object===Object&&self,z=K||q||Function("return this")(),G=Object.prototype,X=G.toString,J=Math.max,Q=Math.min,b=function(){return z.Date.now()};function V(t,e,i){var a,d,h,l,s,o,f=0,E=!1,c=!1,p=!0;if(typeof t!="function")throw new TypeError(W);e=I(e)||0,w(i)&&(E=!!i.leading,c="maxWait"in i,h=c?J(I(i.maxWait)||0,e):h,p="trailing"in i?!!i.trailing:p);function g(r){var n=a,u=d;return a=d=void 0,f=r,l=t.apply(u,n),l}function M(r){return f=r,s=setTimeout(m,e),E?g(r):l}function j(r){var n=r-o,u=r-f,T=e-n;return c?Q(T,h-u):T}function P(r){var n=r-o,u=r-f;return o===void 0||n>=e||n<0||c&&u>=h}function m(){var r=b();if(P(r))return S(r);s=setTimeout(m,j(r))}function S(r){return s=void 0,p&&a?g(r):(a=d=void 0,l)}function A(){s!==void 0&&clearTimeout(s),f=0,a=o=d=s=void 0}function D(){return s===void 0?l:S(b())}function y(){var r=b(),n=P(r);if(a=arguments,d=this,o=r,n){if(s===void 0)return M(o);if(c)return s=setTimeout(m,e),g(o)}return s===void 0&&(s=setTimeout(m,e)),l}return y.cancel=A,y.flush=D,y}function w(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function Y(t){return!!t&&typeof t=="object"}function Z(t){return typeof t=="symbol"||Y(t)&&X.call(t)==B}function I(t){if(typeof t=="number")return t;if(Z(t))return O;if(w(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=w(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(F,"");var i=_.test(t);return i||U.test(t)?N(t.slice(2),i?2:8):H.test(t)?O:+t}x.exports=V});function v(t,e,i={}){t.dispatchEvent(new CustomEvent(e,{detail:i,bubbles:!0,composed:!0,cancelable:!0}))}var $=k(),C=[],L={onEditorFocusOut(t){C.push(t)}};document.addEventListener("alpine:init",()=>{v(document,"peek:initializing"),Alpine.data("PeekPreviewModal",t=>({config:t,isOpen:!1,withEditor:!1,editorHasSidebarActions:!1,canRotatePreset:!1,activeDevicePreset:null,editorTitle:null,modalTitle:null,iframeUrl:null,iframeContent:null,modalStyle:{display:"none"},iframeStyle:{width:"100%",height:"100%",maxWidth:"100%",maxHeight:"100%"},editorStyle:{display:"none"},init(){let e=this.config.editorAutoRefreshDebounceTime||500;this.refreshBuilderPreview=$(()=>Livewire.emit("refreshBuilderPreview"),e),this.setDevicePreset()},setIframeDimensions(e,i){this.iframeStyle.maxWidth=e,this.iframeStyle.maxHeight=i,this.config.allowIframeOverflow&&(this.iframeStyle.width=e,this.iframeStyle.height=i)},setDevicePreset(e){e=e||this.config.initialDevicePreset,!!this.config.devicePresets&&(!this.config.devicePresets[e]||!this.config.devicePresets[e].width||!this.config.devicePresets[e].height||(this.setIframeDimensions(this.config.devicePresets[e].width,this.config.devicePresets[e].height),this.canRotatePreset=this.config.devicePresets[e].canRotatePreset||!1,this.activeDevicePreset=e))},isActiveDevicePreset(e){return this.config.shouldShowActiveDevicePreset?this.activeDevicePreset===e:!1},rotateDevicePreset(){let e=this.iframeStyle.maxHeight,i=this.iframeStyle.maxWidth;this.setIframeDimensions(e,i)},onOpenPreviewModal(e){document.body.classList.add("is-filament-peek-preview-modal-open"),this.withEditor=!!e.detail.withEditor,this.editorHasSidebarActions=!!e.detail.editorHasSidebarActions,this.editorTitle=e.detail.editorTitle,this.editorStyle.display=this.withEditor?"flex":"none",this.modalTitle=e.detail.modalTitle,this.iframeUrl=e.detail.iframeUrl,this.iframeContent=e.detail.iframeContent,this.modalStyle.display="flex",this.isOpen=!0,setTimeout(()=>this._focusEditorFirstInput(),0),setTimeout(()=>this._attachIframeEscapeKeyListener(),500)},_focusEditorFirstInput(){if(!this.withEditor)return;let e=this.$el.querySelector(".filament-peek-builder-editor input");e&&e.focus()},_attachIframeEscapeKeyListener(){let e=this.$refs.previewModalBody.querySelector("iframe");!(e&&e.contentWindow)||e.contentWindow.addEventListener("keyup",i=>{i.key==="Escape"&&this.handleEscapeKey()})},onRefreshPreviewModal(e){this.iframeUrl=e.detail.iframeUrl,this.iframeContent=e.detail.iframeContent},onClosePreviewModal(e){setTimeout(()=>this._closeModal(),e?.detail?.delay?250:0)},_closeModal(){document.body.classList.remove("is-filament-peek-preview-modal-open"),this.withEditor=!1,this.editorHasSidebarActions=!1,this.editorStyle.display="none",this.editorTitle=null,this.modalStyle.display="none",this.modalTitle=null,this.iframeUrl=null,this.iframeContent=null,this.isOpen=!1},onEditorFocusOut(e){if(!!this.editorShouldAutoRefresh())for(let i of C)typeof i=="function"&&i(e,this)},editorShouldAutoRefresh(){if(!!this.withEditor&&!!this.$refs.builderEditor)return!!this.$refs.builderEditor.dataset.shouldAutoRefresh},handleEscapeKey(){!this.isOpen||!this.config.shouldCloseModalWithEscapeKey||this.withEditor||this.onClosePreviewModal()},acceptEditorChanges(){Livewire.emit("closeBuilderEditor")},discardEditorChanges(){this.$dispatch("close-preview-modal")},closePreviewModal(){this.$dispatch("close-preview-modal")}})),v(document,"peek:initialized")});document.addEventListener("peek:initializing",()=>{L.onEditorFocusOut((t,e)=>{if(["input","select","textarea","trix-editor","hex-color-picker"].includes(t.target.tagName.toLowerCase())){e.refreshBuilderPreview();return}if(t.target.tagName.toLowerCase()==="button"&&t.target.getAttribute("role")==="switch"){e.refreshBuilderPreview();return}if(t.target.classList.contains("ProseMirror")){e.refreshBuilderPreview();return}})});window.FilamentPeek=L;})();
