(()=>{var z=(i,e)=>()=>(e||(e={exports:{}},i(e.exports,e)),e.exports);var O=z((re,R)=>{var D="Expected a function",x=0/0,B="[object Symbol]",_=/^\s+|\s+$/g,F=/^[-+]0x[0-9a-f]+$/i,H=/^0b[01]+$/i,U=/^0o[0-7]+$/i,N=parseInt,X=typeof global=="object"&&global&&global.Object===Object&&global,$=typeof self=="object"&&self&&self.Object===Object&&self,q=X||$||Function("return this")(),K=Object.prototype,G=K.toString,Y=Math.max,J=Math.min,S=function(){return q.Date.now()};function Q(i,e,t){var o,l,u,d,s,a,f=0,E=!1,c=!1,g=!0;if(typeof i!="function")throw new TypeError(D);e=M(e)||0,w(t)&&(E=!!t.leading,c="maxWait"in t,u=c?Y(M(t.maxWait)||0,e):u,g="trailing"in t?!!t.trailing:g);function y(r){var n=o,h=l;return o=l=void 0,f=r,d=i.apply(h,n),d}function C(r){return f=r,s=setTimeout(m,e),E?y(r):d}function L(r){var n=r-a,h=r-f,T=e-n;return c?J(T,u-h):T}function P(r){var n=r-a,h=r-f;return a===void 0||n>=e||n<0||c&&h>=u}function m(){var r=S();if(P(r))return I(r);s=setTimeout(m,L(r))}function I(r){return s=void 0,g&&o?y(r):(o=l=void 0,d)}function A(){s!==void 0&&clearTimeout(s),f=0,o=a=l=s=void 0}function j(){return s===void 0?d:I(S())}function b(){var r=S(),n=P(r);if(o=arguments,l=this,a=r,n){if(s===void 0)return C(a);if(c)return s=setTimeout(m,e),y(a)}return s===void 0&&(s=setTimeout(m,e)),d}return b.cancel=A,b.flush=j,b}function w(i){var e=typeof i;return!!i&&(e=="object"||e=="function")}function V(i){return!!i&&typeof i=="object"}function Z(i){return typeof i=="symbol"||V(i)&&G.call(i)==B}function M(i){if(typeof i=="number")return i;if(Z(i))return x;if(w(i)){var e=typeof i.valueOf=="function"?i.valueOf():i;i=w(e)?e+"":e}if(typeof i!="string")return i===0?i:+i;i=i.replace(_,"");var t=H.test(i);return t||U.test(i)?N(i.slice(2),t?2:8):F.test(i)?x:+i}R.exports=Q});function v(i,e,t={}){i.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0,composed:!0,cancelable:!0}))}var ee=O(),W=[],k={onEditorFocusOut(i){W.push(i)}},p={initialWidth:0,initialX:0};document.addEventListener("alpine:init",()=>{v(document,"peek:initializing"),Alpine.data("PeekPreviewModal",i=>({config:i,isOpen:!1,withEditor:!1,editorHasSidebarActions:!1,editorIsResizable:!1,editorIsResizing:!1,canRotatePreset:!1,activeDevicePreset:null,editorTitle:null,modalTitle:null,iframeUrl:null,iframeContent:null,modalStyle:{display:"none"},iframeStyle:{width:"100%",height:"100%",maxWidth:"100%",maxHeight:"100%"},editorStyle:{display:"none"},init(){let e=this.config.editorAutoRefreshDebounceTime||500,t=this.config.editorSidebarMinWidth||"30rem",o=this.config.editorSidebarInitialWidth||"30rem";this.refreshBuilderPreview=ee(()=>Livewire.emit("refreshBuilderPreview"),e),this.editorStyle.width=o,this.config.canResizeEditorSidebar&&(this.editorStyle.minWidth=t,this.editorIsResizable=!0),this.setDevicePreset()},setIframeDimensions(e,t){this.iframeStyle.maxWidth=e,this.iframeStyle.maxHeight=t,this.config.allowIframeOverflow&&(this.iframeStyle.width=e,this.iframeStyle.height=t)},setDevicePreset(e){e=e||this.config.initialDevicePreset,!!this.config.devicePresets&&(!this.config.devicePresets[e]||!this.config.devicePresets[e].width||!this.config.devicePresets[e].height||(this.setIframeDimensions(this.config.devicePresets[e].width,this.config.devicePresets[e].height),this.canRotatePreset=this.config.devicePresets[e].canRotatePreset||!1,this.activeDevicePreset=e))},isActiveDevicePreset(e){return this.activeDevicePreset===e},rotateDevicePreset(){let e=this.iframeStyle.maxHeight,t=this.iframeStyle.maxWidth;this.setIframeDimensions(e,t)},onOpenPreviewModal(e){document.body.classList.add("is-filament-peek-preview-modal-open"),this.withEditor=!!e.detail.withEditor,this.editorHasSidebarActions=!!e.detail.editorHasSidebarActions,this.editorIsResizing=!1,this.editorTitle=e.detail.editorTitle,this.editorStyle.display=this.withEditor?"flex":"none",this.modalTitle=e.detail.modalTitle,this.iframeUrl=e.detail.iframeUrl,this.iframeContent=e.detail.iframeContent,this.modalStyle.display="flex",this.isOpen=!0,setTimeout(()=>this._focusEditorFirstInput(),0),setTimeout(()=>this._attachIframeEscapeKeyListener(),500)},_focusEditorFirstInput(){if(!this.withEditor)return;let e=this.$el.querySelector(".filament-peek-builder-editor input");e&&e.focus()},_attachIframeEscapeKeyListener(){let e=this.$refs.previewModalBody.querySelector("iframe");!(e&&e.contentWindow)||e.contentWindow.addEventListener("keyup",t=>{t.key==="Escape"&&this.handleEscapeKey()})},onRefreshPreviewModal(e){this.config.shouldRestoreIframePositionOnRefresh&&this._restoreIframeScrollPosition(),this.iframeUrl=e.detail.iframeUrl,this.iframeContent=e.detail.iframeContent},_restoreIframeScrollPosition(){let e=this.$refs.previewModalBody.querySelector("iframe");e&&e.contentWindow&&(this._iframeScrollPosition=e.contentWindow.scrollY,setTimeout(()=>{this.$refs.previewModalBody.querySelector("iframe")?.contentWindow?.scrollTo(0,this._iframeScrollPosition||0)},50))},onClosePreviewModal(e){setTimeout(()=>this._closeModal(),e?.detail?.delay?250:0)},_closeModal(){document.body.classList.remove("is-filament-peek-preview-modal-open"),this.withEditor=!1,this.editorHasSidebarActions=!1,this.editorIsResizing=!1,this.editorStyle.display="none",this.editorTitle=null,this.modalStyle.display="none",this.modalTitle=null,this.iframeUrl=null,this.iframeContent=null,this.isOpen=!1},onEditorFocusOut(e){if(!!this.editorShouldAutoRefresh()&&this.getAutoRefreshStrategy()!=="reactive")for(let t of W)typeof t=="function"&&t(e,this)},editorShouldAutoRefresh(){if(!!this.withEditor&&!!this.$refs.builderEditor)return!!this.$refs.builderEditor.dataset.shouldAutoRefresh},getAutoRefreshStrategy(){if(!!this.withEditor&&!!this.$refs.builderEditor)return this.$refs.builderEditor.dataset.autoRefreshStrategy||"simple"},handleEscapeKey(){!this.isOpen||!this.config.shouldCloseModalWithEscapeKey||this.withEditor||this.onClosePreviewModal()},acceptEditorChanges(){Livewire.emit("closeBuilderEditor")},discardEditorChanges(){this.$dispatch("close-preview-modal")},closePreviewModal(){this.$dispatch("close-preview-modal")},onEditorResizerMouseDown(e){!this.$refs.builderEditor||(this.editorIsResizing=!0,p.initialWidth=parseFloat(getComputedStyle(this.$refs.builderEditor).width),p.initialX=e.clientX)},onMouseUp(e){!this.editorIsResizing||(this.editorIsResizing=!1)},onMouseMove(e){!this.editorIsResizing||(this.editorStyle.width=p.initialWidth+(e.clientX-p.initialX)+"px")}})),v(document,"peek:initialized")});document.addEventListener("peek:initializing",()=>{k.onEditorFocusOut((i,e)=>{if(["input","select","textarea","trix-editor","hex-color-picker"].includes(i.target.tagName.toLowerCase())){e.refreshBuilderPreview();return}if(i.target.tagName.toLowerCase()==="button"&&i.target.getAttribute("role")==="switch"){e.refreshBuilderPreview();return}if(i.target.classList.contains("ProseMirror")){e.refreshBuilderPreview();return}})});window.FilamentPeek=k;})();
